// Generated by CoffeeScript 1.6.3
(function() {
  var Q, r, request, _create_method;

  Q = require('q');

  r = require('request');

  request = function(uri, options) {
    var deferred, req;
    if (options == null) {
      options = {};
    }
    deferred = Q.defer();
    req = r(uri, options, function(err, res) {
      if (err) {
        return deferred.reject(err);
      } else {
        return deferred.resolve(res);
      }
    });
    return deferred.promise;
  };

  _create_method = function(uri, options, method) {
    var params;
    if (options == null) {
      options = {};
    }
    params = r.initParams(uri, options, null);
    params.options.method = method;
    return request(params.uri || null, params.options);
  };

  request.get = function(uri, options) {
    return _create_method(uri, options, 'GET');
  };

  request.post = function(uri, options) {
    return _create_method(uri, options, 'POST');
  };

  request.put = function(uri, options) {
    return _create_method(uri, options, 'PUT');
  };

  request.patch = function(uri, options) {
    return _create_method(uri, options, 'PATCH');
  };

  request.head = function(uri, options) {
    var deferred, req;
    if (options == null) {
      options = {};
    }
    deferred = Q.defer();
    req = r.head(uri, options, function(err, res) {
      if (err) {
        return deferred.reject(err);
      } else {
        return deferred.resolve(res);
      }
    });
    return deferred.promise;
  };

  request.del = function(uri, options) {
    return _create_method(uri, options, 'DELETE');
  };

  request.initParams = r.initParams;

  request.jar = r.jar;

  request.cookie = r.cookie;

  request.defaults = function(options) {
    var de, def, key, _i, _len, _ref;
    def = function(method) {
      return function(uri, opt) {
        var key, params, _i, _len;
        params = r.initParams(uri, opt, null);
        for (_i = 0, _len = options.length; _i < _len; _i++) {
          key = options[_i];
          if (parms.options[key] === void 0) {
            parms.options[key] = options[key];
          }
        }
        return method(params.uri, params.options);
      };
    };
    de = def(request);
    _ref = ['get', 'post', 'put', 'patch', 'head', 'del', 'cookie', 'defaults'];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      key = _ref[_i];
      de[key] = def(request[key]);
    }
    de.jar = request.jar;
    return de;
  };

  module.exports = request;

}).call(this);
